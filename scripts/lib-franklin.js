export function sampleRUM(e,t={}){sampleRUM.defer=sampleRUM.defer||[];const o=e=>{sampleRUM[e]=sampleRUM[e]||((...t)=>sampleRUM.defer.push({fnname:e,args:t}))};sampleRUM.drain=sampleRUM.drain||((e,t)=>{sampleRUM[e]=t,sampleRUM.defer.filter((({fnname:t})=>e===t)).forEach((({fnname:e,args:t})=>sampleRUM[e](...t)))}),sampleRUM.on=(e,t)=>{sampleRUM.cases[e]=t},o("observe"),o("cwv");try{if(window.hlx=window.hlx||{},!window.hlx.rum){const e="on"===new URLSearchParams(window.location.search).get("rum")?1:100,t=`${(e=>e.split("").reduce(((e,t)=>(e<<5)-e+t.charCodeAt(0)|0),0))(window.location.href)}-${(new Date).getTime()}-${Math.random().toString(16).substr(2,14)}`,o=Math.random(),a=o*e<1;window.hlx.rum={weight:e,id:t,random:o,isSelected:a,sampleRUM:sampleRUM}}const{weight:o,id:a}=window.hlx.rum;if(window.hlx&&window.hlx.rum&&window.hlx.rum.isSelected){const n=(n=t)=>{const s=JSON.stringify({weight:o,id:a,referer:window.location.href,generation:window.hlx.RUM_GENERATION,checkpoint:e,...t}),l=`https://rum.hlx.page/.rum/${o}`;navigator.sendBeacon(l,s),console.debug(`ping:${e}`,n)};sampleRUM.cases=sampleRUM.cases||{cwv:()=>sampleRUM.cwv(t)||!0,lazy:()=>{const e=document.createElement("script");return e.src="https://rum.hlx.page/.rum/@adobe/helix-rum-enhancer@^1/src/index.js",document.head.appendChild(e),!0}},n(t),sampleRUM.cases[e]&&sampleRUM.cases[e]()}}catch(e){}}export function loadCSS(e,t){if(document.querySelector(`head > link[href="${e}"]`))"function"==typeof t&&t("noop");else{const o=document.createElement("link");o.setAttribute("rel","stylesheet"),o.setAttribute("href",e),"function"==typeof t&&(o.onload=e=>t(e.type),o.onerror=e=>t(e.type)),document.head.appendChild(o)}}export function getMetadata(e){const t=e&&e.includes(":")?"property":"name";return[...document.head.querySelectorAll(`meta[${t}="${e}"]`)].map((e=>e.content)).join(", ")||""}export function toClassName(e){return"string"==typeof e?e.toLowerCase().replace(/[^0-9a-z]/gi,"-").replace(/-+/g,"-").replace(/^-|-$/g,""):""}export function toCamelCase(e){return toClassName(e).replace(/-([a-z])/g,(e=>e[1].toUpperCase()))}const e={};export async function decorateIcons(t){let o=document.getElementById("franklin-svg-sprite");if(!o){const e=document.createElement("div");e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" id="franklin-svg-sprite" style="display: none"></svg>',o=e.firstElementChild,document.body.append(e.firstElementChild)}const a=[...t.querySelectorAll("span.icon")];await Promise.all(a.map((async t=>{const o=Array.from(t.classList).find((e=>e.startsWith("icon-"))).substring(5);if(!e[o]){e[o]=!0;try{const t=await fetch(`${window.hlx.codeBasePath}/icons/${o}.svg`);if(!t.ok)return void(e[o]=!1);const a=await t.text();a.match(/(<style | class=)/)?e[o]={styled:!0,html:a}:e[o]={html:a.replace("<svg",`<symbol id="icons-sprite-${o}"`).replace(/ width=".*?"/,"").replace(/ height=".*?"/,"").replace("</svg>","</symbol>")}}catch(t){e[o]=!1,console.error(t)}}})));const n=Object.values(e).filter((e=>!e.styled)).map((e=>e.html)).join("\n");o.innerHTML+=n,a.forEach((t=>{const o=Array.from(t.classList).find((e=>e.startsWith("icon-"))).split("-")[1],a="A"===t.firstElementChild?.tagName?t.firstElementChild:t;e[o].styled?a.innerHTML=e[o].html:a.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg"><use href="#icons-sprite-${o}"/></svg>`}))}export async function fetchPlaceholders(e="default"){window.placeholders=window.placeholders||{};return window.placeholders[`${e}-loaded`]||(window.placeholders[`${e}-loaded`]=new Promise(((t,o)=>{try{fetch(`${"default"===e?"":e}/placeholders.json`).then((e=>e.json())).then((o=>{const a={};o.data.forEach((e=>{a[toCamelCase(e.Key)]=e.Text})),window.placeholders[e]=a,t()}))}catch(t){window.placeholders[e]={},o()}}))),await window.placeholders[`${e}-loaded`],window.placeholders[e]}export function decorateBlock(e){const t=e.classList[0];if(t){e.classList.add("block"),e.dataset.blockName=t,e.dataset.blockStatus="initialized";e.parentElement.classList.add(`${t}-wrapper`);const o=e.closest(".section");o&&o.classList.add(`${t}-container`)}}export function readBlockConfig(e){const t={};return e.querySelectorAll(":scope > div").forEach((e=>{if(e.children){const o=[...e.children];if(o[1]){const a=o[1],n=toClassName(o[0].textContent);let s="";if(a.querySelector("a")){const e=[...a.querySelectorAll("a")];s=1===e.length?e[0].href:e.map((e=>e.href))}else if(a.querySelector("img")){const e=[...a.querySelectorAll("img")];s=1===e.length?e[0].src:e.map((e=>e.src))}else if(a.querySelector("p")){const e=[...a.querySelectorAll("p")];s=1===e.length?e[0].textContent:e.map((e=>e.textContent))}else s=e.children[1].textContent;t[n]=s}}})),t}export function decorateSections(e){e.querySelectorAll(":scope > div").forEach((e=>{const t=[];let o=!1;[...e.children].forEach((e=>{if("DIV"===e.tagName||!o){const a=document.createElement("div");t.push(a),o="DIV"!==e.tagName,o&&a.classList.add("default-content-wrapper")}t[t.length-1].append(e)})),t.forEach((t=>e.append(t))),e.classList.add("section"),e.dataset.sectionStatus="initialized",e.style.display="none";const a=e.querySelector("div.section-metadata");if(a){const t=readBlockConfig(a);Object.keys(t).forEach((o=>{if("style"===o){t.style.split(",").map((e=>toClassName(e.trim()))).forEach((t=>e.classList.add(t)))}else e.dataset[toCamelCase(o)]=t[o]})),a.parentNode.remove()}}))}export function updateSectionsStatus(e){const t=[...e.querySelectorAll(":scope > div.section")];for(let e=0;e<t.length;e+=1){const o=t[e];if("loaded"!==o.dataset.sectionStatus){if(o.querySelector('.block[data-block-status="initialized"], .block[data-block-status="loading"]')){o.dataset.sectionStatus="loading";break}o.dataset.sectionStatus="loaded",o.style.display=null}}}export function decorateBlocks(e){e.querySelectorAll("div.section > div > div").forEach(decorateBlock)}export function buildBlock(e,t){const o=Array.isArray(t)?t:[[t]],a=document.createElement("div");return a.classList.add(e),o.forEach((e=>{const t=document.createElement("div");e.forEach((e=>{const o=document.createElement("div");(e.elems?e.elems:[e]).forEach((e=>{e&&("string"==typeof e?o.innerHTML+=e:o.appendChild(e))})),t.appendChild(o)})),a.appendChild(t)})),a}export async function loadBlock(e){const t=e.dataset.blockStatus;if("loading"!==t&&"loaded"!==t){e.dataset.blockStatus="loading";const{blockName:t}=e.dataset;try{const o=new Promise((e=>{loadCSS(`${window.hlx.codeBasePath}/blocks/${t}/${t}.css`,e)})),a=new Promise((o=>{(async()=>{try{const o=await import(`../blocks/${t}/${t}.js`);o.default&&await o.default(e)}catch(e){console.log(`failed to load module for ${t}`,e)}o()})()}));await Promise.all([o,a])}catch(e){console.log(`failed to load block ${t}`,e)}e.dataset.blockStatus="loaded"}}export async function loadBlocks(e){updateSectionsStatus(e);const t=[...e.querySelectorAll("div.block")];for(let o=0;o<t.length;o+=1)await loadBlock(t[o]),updateSectionsStatus(e)}export function createOptimizedPicture(e,t="",o=!1,a=[{media:"(min-width: 600px)",width:"2000"},{width:"750"}]){const n=new URL(e,window.location.href),s=document.createElement("picture"),{pathname:l}=n,c=l.substring(l.lastIndexOf(".")+1);return a.forEach((e=>{const t=document.createElement("source");e.media&&t.setAttribute("media",e.media),t.setAttribute("type","image/webp"),t.setAttribute("srcset",`${l}?width=${e.width}&format=webply&optimize=medium`),s.appendChild(t)})),a.forEach(((e,n)=>{if(n<a.length-1){const t=document.createElement("source");e.media&&t.setAttribute("media",e.media),t.setAttribute("srcset",`${l}?width=${e.width}&format=${c}&optimize=medium`),s.appendChild(t)}else{const a=document.createElement("img");a.setAttribute("loading",o?"eager":"lazy"),a.setAttribute("alt",t),s.appendChild(a),a.setAttribute("src",`${l}?width=${e.width}&format=${c}&optimize=medium`)}})),s}export function normalizeHeadings(e,t){const o=t.map((e=>e.toLowerCase()));e.querySelectorAll("h1, h2, h3, h4, h5, h6").forEach((e=>{const t=e.tagName.toLowerCase();if(-1===o.indexOf(t)){let a=parseInt(t.charAt(1),10)-1;for(;-1===o.indexOf(`h${a}`)&&a>0;)a-=1;if(0===a)for(;-1===o.indexOf(`h${a}`)&&a<7;)a+=1;7!==a&&(e.outerHTML=`<h${a} id="${e.id}">${e.textContent}</h${a}>`)}}))}export function decorateTemplateAndTheme(){const e=(e,t)=>{t.split(",").forEach((t=>{e.classList.add(toClassName(t.trim()))}))},t=getMetadata("template");t&&e(document.body,t);const o=getMetadata("theme");o&&e(document.body,o)}export function decorateButtons(e){e.querySelectorAll("a").forEach((e=>{if(e.title=e.title||e.textContent,e.href!==e.textContent){const t=e.parentElement,o=e.parentElement.parentElement;e.querySelector("img")||(1!==t.childNodes.length||"P"!==t.tagName&&"DIV"!==t.tagName||(e.className="button primary",t.classList.add("button-container")),1===t.childNodes.length&&"STRONG"===t.tagName&&1===o.childNodes.length&&"P"===o.tagName&&(e.className="button primary",o.classList.add("button-container")),1===t.childNodes.length&&"EM"===t.tagName&&1===o.childNodes.length&&"P"===o.tagName&&(e.className="button secondary",o.classList.add("button-container")))}}))}export async function waitForLCP(e){const t=document.querySelector(".block");t&&e.includes(t.dataset.blockName)&&await loadBlock(t),document.body.style.display=null;const o=document.querySelector("main img");await new Promise((e=>{o&&!o.complete?(o.setAttribute("loading","eager"),o.addEventListener("load",e),o.addEventListener("error",e)):e()}))}export function loadHeader(e){const t=buildBlock("header","");return e.append(t),decorateBlock(t),loadBlock(t)}export function loadFooter(e){const t=buildBlock("footer","");return e.append(t),decorateBlock(t),loadBlock(t)}export function setup(){window.hlx=window.hlx||{},window.hlx.codeBasePath="",window.hlx.lighthouse="on"===new URLSearchParams(window.location.search).get("lighthouse");const e=document.querySelector('script[src$="/scripts/scripts.js"]');if(e)try{[window.hlx.codeBasePath]=new URL(e.src).pathname.split("/scripts/scripts.js")}catch(e){console.log(e)}}document.body.style.display="none",setup(),sampleRUM("top"),window.addEventListener("load",(()=>sampleRUM("load"))),window.addEventListener("unhandledrejection",(e=>{sampleRUM("error",{source:e.reason.sourceURL,target:e.reason.line})})),window.addEventListener("error",(e=>{sampleRUM("error",{source:e.filename,target:e.lineno})}));
